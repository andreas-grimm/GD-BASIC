10 REM HEAPSORT
20 OPTION BASE 0
40 REM N IS NUMBER OF ELEMENTS USED IN ARRAY A
50 REM ARRAY A HAS THE DATA TO SORT
90 RANDOMIZE
100 LET N=1000
110 DIM A(1000)
120 FOR I=0 TO N-1 STEP 1
130 LET A(I)=INT(RND*100000)
140 NEXT I
150 PRINT "UNSORTED LIST"
160 GOSUB 400
170 REM DO THE SORT
200 GOSUB 1000
210 PRINT "SORTED LIST"
220 GOSUB 500
230 STOP
400 REM SUBROUTINE TO PRINT ARRAY A CONTENTS
410 FOR I=0 TO N-1 STEP 1
420 PRINT "A(";I;")=";A(I)
430 NEXT I
440 RETURN
500 REM SUBROUTINE TO PRINT ARRAY A CONTENTS
510 REM AND CHECK THEY ARE SORTED
520 FOR I=0 TO N-2 STEP 1
530 IF A(I)<=A(I+1) THEN 550
540 PRINT "SORT ERROR AT THIS SLOT ";
550 PRINT "A(";I;")=";A(I)
560 NEXT I
570 PRINT "A(";N-1;")=";A(N-1)
580 RETURN
1000 REM HEAPSORT A FROM 0 .. N-1
1010 FOR K=INT(N/2)-1 TO 0 STEP -1
1012 LET K1=K
1014 LET N1=N
1020 GOSUB 6000
1030 NEXT K
1040 FOR K=N-1 TO 1 STEP -1
1050 LET V=A(0)
1060 LET A(0)=A(K)
1062 LET K1=0
1064 LET N1=K
1070 GOSUB 6000
1080 LET A(K)=V
1090 NEXT K
5000 RETURN
6000 REM SIFTDOWN K1 N1
6010 LET V1=A(K1)
6020 LET J=2*K1+1
6030 IF J>N1-1 THEN 6120
6040 IF J>=N1-1 THEN 6070
6050 IF A(J)>=A(J+1) THEN 6070
6060 LET J=J+1
6070 IF V1>=A(J) THEN 6120
6080 LET A(K1)=A(J)
6090 LET K1=J
6100 LET J=2*K1+1
6110 GOTO 6030
6120 LET A(K1)=V1
6130 RETURN
9999 END
